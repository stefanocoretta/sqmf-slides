<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistics and Quantitative Methods (S1)</title>
    <meta charset="utf-8" />
    <meta name="author" content="Dr Stefano Coretta" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/freezeframe/freezeframe.min.js"></script>
    <script src="libs/xaringanExtra-freezeframe/freezeframe-init.js"></script>
    <script id="xaringanExtra-freezeframe-options" type="application/json">{"selector":"img[src$=\"gif\"]","trigger":"click","overlay":false,"responsive":true,"warnings":true}</script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Statistics and Quantitative Methods (S1)
]
.subtitle[
## Week 3
]
.author[
### Dr Stefano Coretta
]
.institute[
### University of Edinburgh
]
.date[
### 2022/10/04
]

---







# Slido quiz 1

.f3[*Which of the following is the formula of a straight line?*]

&lt;br&gt;

.pull-left[
.f3[Join at]

.f1[slido.com]

.f1[\#2272 798]
]

.pull-right[
.center[
![](../../img/QR-SQM-1-Week-3.png)
]
]

???

Slido poll. &lt;https://app.sli.do/event/krtv5FmoQy4ESjd45RhHQF&gt;


---

class: inverse
background-image: url(../../img/time-travel.jpg)
background-size: contain

# Time travel...

---

layout: true

# Given the .green[formula], find the .orange[points]

---

## You have:

.f2[$$x = (2, 4, 5, 8, 10, 23, 36)$$]

.f2[$$y = 3 + 2x$$]

## Find:

.f2[$$y$$]


---

&lt;img src="index_files/figure-html/homework-1.png" height="500px" style="display: block; margin: auto;" /&gt;

---

&lt;img src="index_files/figure-html/line-1.png" height="500px" style="display: block; margin: auto;" /&gt;

---

layout: false
layout: true

# Given the .orange[points], find the .green[formula]

---

## You have:

.f2[$$x = (2, 4, 5, 8, 10, 23, 36)$$]

.f2[$$y = (8, 14, 17, 26, 32, 71, 110)$$]

## Find:

.f2[$$y = ? + ? x$$]

---

&lt;img src="index_files/figure-html/sample-1.png" height="500px" style="display: block; margin: auto;" /&gt;

---

layout: false

# But...

.pull-left[
![](../../img/world-data.jpg)
]

.pull-right[
.f2[Data is an .red[imperfect] representation of the world!]

Measurements are .red[noisy].
]

---

# Given the .orange[points], find the .green[formula]

&lt;img src="index_files/figure-html/sample-noisy-1.png" height="500px" style="display: block; margin: auto;" /&gt;

---

class: center middle inverse

# If `\(x\)` changes, what happens to `\(y\)`?

---

# Now enter Linear Models

&lt;div style="width:100%;height:0;padding-bottom:42%;position:relative;"&gt;&lt;iframe src="https://giphy.com/embed/3owzVYjZSzuFivWpHi" width="100%" height="100%" style="position:absolute" frameBorder="0" class="giphy-embed" allowFullScreen&gt;&lt;/iframe&gt;&lt;/div&gt;

???

[via GIPHY](https://giphy.com/gifs/starwars-movie-star-wars-3owzVYjZSzuFivWpHi)

---

layout: true

# Linear model: the basics

---

&lt;img src="index_files/figure-html/lm-plot-1.png" height="500px" style="display: block; margin: auto;" /&gt;

---

&lt;img src="index_files/figure-html/lm-plot-2-1.png" height="500px" style="display: block; margin: auto;" /&gt;

---

.f1[
`$$y = ? + ? x$$`
]

---

.f1[
`$$y = \beta_0 + \beta_1x$$`
]

&lt;br&gt;

--

.f2[
`$$\beta_0 = intercept$$`
`$$\beta_1 = slope$$`
]

--

&lt;br&gt;

We know `\(x\)` and `\(y\)` and we need to .green[estimate] `\(\beta_0\)` and `\(\beta_1\)`.


---

layout: false
class: center middle

&lt;iframe src="https://stefanocoretta.shinyapps.io/lines/" width="1200" height="600"&gt;&lt;/iframe&gt;


???

&lt;https://stefanocoretta.shinyapps.io/lines/&gt;

---

# Slido quiz 2

.f3[*Which of the following is NOT the formula of a straight line?*]

&lt;br&gt;

.pull-left[
.f3[Join at]

.f1[slido.com]

.f1[\#2272 798]
]

.pull-right[
.center[
![](../../img/QR-SQM-1-Week-3.png)
]
]

???

Slido poll. &lt;https://app.sli.do/event/krtv5FmoQy4ESjd45RhHQF&gt;

---

layout: true

# Linear model: the basics

---

&lt;img src="index_files/figure-html/sample-2-1.png" height="500px" style="display: block; margin: auto;" /&gt;

---


```r
line_lm &lt;- lm(y ~ x, data = line_2)
summary(line_lm)
```

```
## 
## Call:
## lm(formula = y ~ x, data = line_2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -25.2197  -5.2243   0.3434   6.2411  20.7275 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  1.99182    2.66626   0.747    0.459
## x            3.02079    0.04762  63.432   &lt;2e-16
## 
## Residual standard error: 10.07 on 48 degrees of freedom
## Multiple R-squared:  0.9882,	Adjusted R-squared:  0.988 
## F-statistic:  4024 on 1 and 48 DF,  p-value: &lt; 2.2e-16
```

---

&lt;img src="index_files/figure-html/line-model-1.png" height="500px" style="display: block; margin: auto;" /&gt;

---

layout: false
layout: true

# Standard error

---


```r
summary(line_lm)
```

```
## 
## Call:
## lm(formula = y ~ x, data = line_2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -25.2197  -5.2243   0.3434   6.2411  20.7275 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  1.99182    2.66626   0.747    0.459
## x            3.02079    0.04762  63.432   &lt;2e-16
## 
## Residual standard error: 10.07 on 48 degrees of freedom
## Multiple R-squared:  0.9882,	Adjusted R-squared:  0.988 
## F-statistic:  4024 on 1 and 48 DF,  p-value: &lt; 2.2e-16
```

???

The **standard error** is a measure of (lack of) precision of the estimates.

The greater the standard error the least precise the estimate is.

Standard errors tend to decrease with more data.

---

&lt;img src="index_files/figure-html/se-1.png" height="500px" style="display: block; margin: auto;" /&gt;

???

In this plot you see a set of lines that represent some of the possible lines that are a good fit for the data (according to the model).

These lines are a random selection from all the possible lines that are compatible with the estimates and standard errors calculated by the model.

In other words, any of these could be the actual line that "generated" the data.
**We cannot be sure because of the error each estimate comes with!**

---

Let's try now with more data (N = 300).


```
## 
## Call:
## lm(formula = y ~ x, data = line_3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -29.718  -6.762  -0.188   6.479  40.657 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  2.10313    1.18137    1.78   0.0761
## x            2.99189    0.02079  143.94   &lt;2e-16
## 
## Residual standard error: 10.05 on 298 degrees of freedom
## Multiple R-squared:  0.9858,	Adjusted R-squared:  0.9858 
## F-statistic: 2.072e+04 on 1 and 298 DF,  p-value: &lt; 2.2e-16
```

---

&lt;img src="index_files/figure-html/se-2-1.png" height="500px" style="display: block; margin: auto;" /&gt;

???

Compare this to the previous plot.

Now the lines are much less variable, because the error of the estimates is smaller.
(Of course it is, there is much more data to estimate those numbers with!)

---

layout: false
layout: true

# Residuals

---

&lt;img src="index_files/figure-html/line-model-2-1.png" height="500px" style="display: block; margin: auto;" /&gt;

---

&lt;img src="index_files/figure-html/line-model-3-1.png" height="500px" style="display: block; margin: auto;" /&gt;

???

A **residual** is the difference between the *y* value of a raw data point and the predicted value for the *x* value of that point.

One way to estimate linear models is to find the line that minimises the residuals across all data points.
There are other methods, but for the purpose of applied data analysis, it doesn't matter which one is used and specific R packages use specific methods.

---

&lt;img src="index_files/figure-html/line-model-4-1.png" height="500px" style="display: block; margin: auto;" /&gt;

???

See how the residuals here are much larger, because the line is "off" relative to the data points?

---

&lt;img src="index_files/figure-html/line-model-5-1.png" height="500px" style="display: block; margin: auto;" /&gt;

???

Another example of bad "fit" of the line (or model) to the data.

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="../../assets/macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
