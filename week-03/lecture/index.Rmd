---
title: "Statistics and Quantitative Methods (S1)"
subtitle: "Week 3"
author: "Dr Stefano Coretta"
institute: "University of Edinburgh"
date: "2022/09/01"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css:
      - xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      beforeInit: "../../assets/macros.js"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, dpi = 300, out.height = "500px", fig.align = "center")
knitr::opts_knit$set(root.dir = here::here())
options(htmltools.dir.version = FALSE)
library(tidyverse)
theme_set(theme_light())
library(xaringanExtra)
use_xaringan_extra(c("panelset", "tachyons", "freezeframe"))
options(show.signif.stars = FALSE)
set.seed(80788)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_light(
  base_color = "#23395b",
  text_font_google = google_font("Lato", "400", "700", "400i", "700i"),
  header_font_google = google_font("Montserrat", "400", "700", "400i", "700i"),
  code_font_google = google_font("Source Code Pro", "400", "700")
)
```

class: center middle inverse

# Slido quiz 1

---

class: inverse
background-image: url(../img/time-travel.jpg)
background-size: contain

# Time travel...

---

layout: true

# Given the .green[formula], find the .orange[points]

---

## You have:

.f2[$$x = (2, 4, 5, 8, 10, 23, 36)$$]

.f2[$$y = 3 + 2x$$]

## Find:

.f2[$$y$$]


---

```{r homework}
x <- c(2, 4, 5, 8, 10, 23, 36)
y <- 2 + (3 * x)
line <- tibble(
  x = x,
  y = y
)
ggplot(line, aes(x, y)) +
  geom_point(size = 5) +
  labs(title = bquote(italic(y) == 2 + 3 * italic(x)))
```

---

```{r line}
ggplot(line, aes(x, y)) +
  geom_point(size = 5, colour = "gray") +
  geom_line(colour = "red") +
  labs(title = bquote(italic(y) == 2 + 3 * italic(x)))
```

---

## You have:

.f2[$$x = (2, 4, 5, 8, 10, 23, 36)$$]

.f2[$$y = (8, 14, 17, 26, 32, 71, 110)$$]

## Find:

.f2[$$y = ? + ? x$$]

---

layout: false

# Given the .orange[points], find the .green[formula]

---

```{r sample}
ggplot(line, aes(x, y)) +
  geom_point(size = 5) +
  labs(title = bquote(italic(y) == "?" + "?" * italic(x)))
```

---

# But...

.pull-left[
![](../img/world-data.jpg)
]

.pull-right[
.f2[Data is an .red[imperfect] representation of the world!]

Measurements are .red[noisy].
]

---

# Given the .orange[points], find the .green[formula]

```{r sample-noisy}
set.seed(4321)
line$y <- line$y + rnorm(7, 0, 10)
ggplot(line, aes(x, y)) +
  geom_point(size = 5) +
  labs(title = bquote(italic(y) == "?" + "?" * italic(x)))
```

---

class: center middle inverse

# If $x$ changes, what happens to $y$?

---

# Now enter Linear Models

<div style="width:100%;height:0;padding-bottom:42%;position:relative;"><iframe src="https://giphy.com/embed/3owzVYjZSzuFivWpHi" width="100%" height="100%" style="position:absolute" frameBorder="0" class="giphy-embed" allowFullScreen></iframe></div>

???

[via GIPHY](https://giphy.com/gifs/starwars-movie-star-wars-3owzVYjZSzuFivWpHi)

---

layout: true

# Linear model: the basics

---

```{r lm-plot}
ggplot(line, aes(x, y)) +
  geom_point(size = 5, ) +
  geom_abline(intercept = 10, slope = 1, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 30, slope = 2, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = -20, slope = 4, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 15, slope = 6, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 2, slope = 3, size = 2, colour = "blue", alpha = 0.2) +
  labs(title = bquote({italic(y) == "?" + "?" * italic(x)}))
```

---

```{r lm-plot-2}
ggplot(line, aes(x, y)) +
  geom_point(size = 5, ) +
  geom_abline(intercept = 10, slope = 1, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 30, slope = 2, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = -20, slope = 4, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 15, slope = 6, size = 2, colour = "blue", alpha = 0.2) +
  geom_abline(intercept = 2, slope = 3, size = 2, colour = "blue") +
  labs(title = bquote({italic(y) == "?" + "?" * italic(x)}))
```

---

.f1[
$$y = ? + ? x$$
]

---

.f1[
$$y = \beta_0 + \beta_1x$$
]

<br>

--

.f2[
$$\beta_0 = intercept$$
$$\beta_1 = slope$$
]

--

<br>

We know $x$ and $y$ and we need to .green[estimate] $\beta_0$ and $\beta_1$.


---

layout: false

class: center middle inverse

# Slido quiz 2

---

layout: true

# Linear model: the basics

---

```{r sample-2}
x <- sample(1:100, 50)
y <- 2 + (3 * x) + rnorm(length(x), 0, 10)

line <- tibble(x, y)

ggplot(line, aes(x, y)) +
  geom_point(size = 5) +
  labs(title = bquote(italic(y) == "?" + "?" * italic(x)))
```

---

```{r line-lm, echo=TRUE}
line_lm <- lm(y ~ x, data = line)
summary(line_lm)
```

---

```{r line-model}
ggplot(line, aes(x, y)) +
  geom_point(size = 5, alpha = 0.5) +
  geom_abline(intercept = 2, slope = 3, size = 2) +
  labs(title = bquote(italic(y) == "2" + "3" * italic(x)))
```

---

layout: false

# Standard error

```{r se}
ggplot(line, aes(x, y)) +
  geom_point(size = 5, alpha = 0.1) +
  geom_abline(intercept = rnorm(100, 2, 2.66), slope = rnorm(100, 3, 0.05), size = 0.5, alpha = 0.05) +
  labs(title = bquote(italic(y) == "2" + "3" * italic(x)))
```


---

layout: true

# Checking residuals

---

```{r fig.asp=1}
plot(line_lm, which = 2)
```

---

```{r}
x_c <- sample(1:100, 50)
y_c <- 2 + (3 * x_c) + (0.5 * x_c^2) + rnorm(length(x_c), 0, 100)

curve <- tibble(x_c, y_c)

curve %>%
  ggplot(aes(x_c, y_c)) +
  geom_point() +
  geom_smooth(method = "lm")
```

---

```{r fig.asp=1}
curve_lm <- lm(y_c ~ x_c, data = curve)

plot(curve_lm, which = 2)
```


---

layout: false

```{r sample-3}
x <- rnorm(200, 2, 0.5)
z <- rnorm(200, -3.5, 1)
y <- 12 + (3 * x) + (1.5 * z) + rnorm(length(x), 0, 4)

sample_3 <- tibble(x, z, y)

ggplot(sample_3, aes(y)) +
  geom_density(fill = "darkgreen", alpha = 0.5) +
  geom_rug()
```
