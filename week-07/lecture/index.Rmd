---
title: "Statistics and Quantitative Methods (S1)"
subtitle: "Week 7"
author: "Dr Stefano Coretta"
institute: "University of Edinburgh"
date: "2022/09/01"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css:
      - xaringan-themer.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      beforeInit: "../../assets/macros.js"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, dpi = 300, out.height = "500px", fig.align = "center")
knitr::opts_knit$set(root.dir = here::here())
options(htmltools.dir.version = FALSE)
library(tidyverse)
theme_set(theme_light())
library(magrittr)
library(xaringanExtra)
use_xaringan_extra(c("panelset", "tachyons", "freezeframe"))
library(ggeffects)
library(marginaleffects)
options(show.signif.stars = FALSE)
library(broom.mixed)
library(sqmf)
data("dur_ita_pol")
dur_ita_pol %<>% drop_na(f1, v1_duration)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_light(
  base_color = "#23395b",
  text_font_google = google_font("Lato", "400", "700", "400i", "700i"),
  header_font_google = google_font("Montserrat", "400", "700", "400i", "700i"),
  code_font_google = google_font("Source Code Pro", "400", "700")
)
```

# Vowel duration and consonant voicing

Details of study

---

```{r}
ggplot(dur_ita_pol, aes(c2_phonation, v1_duration)) +
  geom_jitter(aes(colour = c2_phonation), size = 1, alpha = 0.25, width = 0.2) +
  geom_boxplot(aes(fill = c2_phonation), width = 0.025)
```

---

```{r}
ggplot(dur_ita_pol, aes(language, v1_duration)) +
  geom_jitter(aes(colour = language), size = 1, alpha = 0.25, width = 0.2) +
  geom_boxplot(aes(fill = language), width = 0.025)
```

---

class: center middle inverse

# Is the effect of C2 voicing the same in Italian and Polish?

---

```{r}
jd_pos <- position_jitterdodge(dodge.width = 0.8, jitter.width = 0.2)
d_pos <- position_dodge(width = 0.8)

ggplot(dur_ita_pol, aes(language, v1_duration)) +
  geom_jitter(aes(colour = c2_phonation), size = 1, alpha = 0.25, position = jd_pos) +
  geom_boxplot(aes(fill = c2_phonation), position = d_pos, width = 0.05)
```

---

```{r}
vdur_lm <- lm(v1_duration ~ c2_phonation + language, data = dur_ita_pol)

summary(vdur_lm)
```

---

```{r}
ggpredict(vdur_lm, terms = "c2_phonation")
```

```{r}
ggpredict(vdur_lm, terms = "language")
```

---

```{r}
ggpredict(vdur_lm, terms = c("c2_phonation", "language"))
```

---

```{r}
marginaleffects(vdur_lm, variables = "c2_phonation", by = "language")
```


---

# Without interaction term

$$\text{v1_duration} = \beta_0 + \beta_1 \cdot \text{c2_phonation} + \beta_2 \cdot \text{language}$$

<br>

--

$$\text{v1_duration(voiced, Italian)} = \beta_0 + \beta_1 \cdot 0 + \beta_2 \cdot 0 = \beta_0$$

$$\text{v1_duration(voiceless, Italian)} = \beta_0 + \beta_1 \cdot 1 + \beta_2 \cdot 0 = \beta_0 + \beta_1$$
$$\text{v1_duration(voiced, Polish)} = \beta_0 + \beta_1 \cdot 0 + \beta_2 \cdot 1 = \beta_0 + \beta_2$$

$$\text{v1_duration(voiceless, Polish)} = \beta_0 + \beta_1 \cdot 1 + \beta_2 \cdot 1 = \beta_0 + \beta_1 + \beta_2$$

---

# With interaction term

$$\text{v1_duration} = \beta_0 + \beta_1 \cdot \text{c2_phonation} + \beta_2 \cdot \text{language} + \beta_3 \cdot \text{c2_phonation} \cdot \text{language}$$

<br>

--

$$\text{v1_duration(voiced, Italian)} = \beta_0 + \beta_1 \cdot 0 + \beta_2 \cdot 0 + \beta_3 \cdot 0 \cdot 0= \beta_0$$

$$\text{v1_duration(voiceless, Italian)} = \beta_0 + \beta_1 \cdot 1 + \beta_2 \cdot 0 + \beta_3 \cdot 1 \cdot 0 = \beta_0 + \beta_1$$
$$\text{v1_duration(voiced, Polish)} = \beta_0 + \beta_1 \cdot 0 + \beta_2 \cdot 1 + \beta_3 \cdot 0 \cdot 1 = \beta_0 + \beta_2$$

$$\text{v1_duration(voiceless, Polish)} = \beta_0 + \beta_1 \cdot 1 + \beta_2 \cdot 1 + \beta_3 \cdot 1 \cdot 1 = \beta_0 + \beta_1 + \beta_2 + \beta_3$$


---

# Interactions

```{r lm-interaction, echo=TRUE}
vdur_lm_2 <- lm(
  v1_duration ~ 
    c2_phonation + 
    language + 
    # interaction term
    c2_phonation:language,
  data = dur_ita_pol
)

summary(vdur_lm_2)
```

---

```{r}
ggpredict(vdur_lm_2, terms = c("c2_phonation", "language"))
```

---

```{r}
marginaleffects(vdur_lm_2, variables = "c2_phonation", by = "language")
```

---

```{r}
ggpredict(vdur_lm_2, terms = c("c2_phonation", "language")) %>%
  plot()
```

---


* Categorical predictors are .orange[dummy coded].

* .orange[**Interactions**] model differences of the effects of the predictors on the outcome across groups/conditions.

---

# Exercise 1

```{r art-rate}
art_lm_1 <- lm(articulation_rate ~ attitude * musicstudent, data = polite)

summary(art_lm_1)
```

---

# Exercise 1

```{r art-rate-plot}
ggpredict(art_lm_1, terms = c("musicstudent", "attitude")) %>%
  plot() +
  theme(text = element_text(size = 20))
```

---

# Exercise 2

```{r f0}
f0_lm_1 <- lm(f0mn ~ attitude * years_in_ger, data = polite)

summary(f0_lm_1)
```

---

# Exercise 2

```{r f0-plot}
ggpredict(f0_lm_1, terms = c("attitude", "years_in_ger [1,3,6,9]")) %>%
  plot() +
  theme(text = element_text(size = 20))
```

---

# Exercise 3

```{r ct}
gestures <- read_csv("04-fit-models/gestures.csv") %>%
  mutate(
    background = factor(background, levels = c("English", "Chinese", "Bengali"))
  )

ct_lm_1 <- lm(ct ~ count * gesture * background, data = gestures)

summary(ct_lm_1)
```

---

# Exercise 3

```{r ct-plot}
ggpredict(ct_lm_1, terms = c("count", "gesture", "background")) %>%
  plot() +
  theme(text = element_text(size = 20))
```

---

# Do you notice something weird?

```{r ct-plot-2}
ggpredict(ct_lm_1, terms = c("count", "gesture", "background")) %>%
  plot() +
  theme(text = element_text(size = 20))
```

